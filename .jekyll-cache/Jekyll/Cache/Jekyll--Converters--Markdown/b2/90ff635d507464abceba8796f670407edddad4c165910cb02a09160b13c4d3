I"<p>kubernetes on GKEã§Letâ€™s Encryptã‚’ä½¿ã£ãŸã¨ãã®ãƒ¡ãƒ¢</p>

<p>kubenetesã§Letâ€™s Encryptã‚’ä½¿ã†ã®ã«ã€<a href="https://github.com/jetstack/kube-lego">kube-lego</a>ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>

<p>kube-legoã§ã¯GCEã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã¨Nginx Ingress ControllerãŒä½¿ãˆã‚‹ã‚ˆã†ã§ã™ãŒã€ä»Šå›ã¯ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‚’ä½¿ã†æ‰‹é †ã§ã‚„ã‚Šã¾ã™ï¼ˆã“ã®ã‚ãŸã‚Šã‚ˆãåˆ†ã‹ã£ã¦ã„ãªã„â€¦)ã€‚</p>

<p>Â </p>

<p>7æœˆ13æ—¥è¿½è¨˜</p>

<p>GCEã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‚’ä½¿ã‚ãªã„æ‰‹é †ãŒã§ãã¾ã—ãŸã€‚</p>

<p>https://github.com/kter/kube-study/tree/master/ingress/nginx-tls</p>

<h3 id="kube-legoã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">kube-legoã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>

<pre class="lang:default decode:true ">git clone https://github.com/jetstack/kube-lego.git
vim kube-lego/examples/gce/lego/configmap.yaml</pre>

<p>(ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è‡ªåˆ†ã®ã‚‚ã®ã«ç·¨é›†)</p>

<p>Â </p>

<h3 id="ipã®æ‰•ã„å‡ºã—">IPã®æ‰•ã„å‡ºã—</h3>

<p>IPã‚’æ‰•ã„å‡ºã™</p>

<pre class="lang:default decode:true ">gcloud compute addresses create "IPã®è­˜åˆ¥å" --global</pre>

<p>æ‰•ã„å‡ºã—ãŸIPã«ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç´ä»˜ã‘ã¦ãŠãã€‚</p>

<p>Â </p>

<h3 id="ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ">ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h3>

<p>kube-legoã§ä½¿ç”¨ã™ã‚‹nginx-ingress.ymlã‚’ä½œæˆã™ã‚‹ã€‚</p>

<p>SSLåŒ–ã—ãŸã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸‹è¨˜web-service.ymlã¨ã—ãŸå ´åˆã€nginx-ingress.ymlã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã®ã§é©å½“ãªå ´æ‰€ã«ä½œæˆã—ã¦ãŠãã€‚</p>

<p>Â </p>

<h3 id="kube-legoã‚’ä½œæˆã™ã‚‹">kube-legoã‚’ä½œæˆã™ã‚‹</h3>

<pre class="lang:default decode:true ">cd kube-lego/examples/gce
kubectl apply -f lego/00-namespace.yaml
kubectl apply -f lego/configmap.yaml
kubectl apply -f lego/deployment.yaml
kubectl create -f /path/to/nginx-ingress.yml</pre>

<p>è¨­å®šãŒåæ˜ ã•ã‚Œã‚‹ã¾ã§ã€åæ•°åˆ†æ›ã‹ã‚‹ã®ã§æš«ãå¾…ã¤ã€‚</p>

<h3 id="å‚™è€ƒ">å‚™è€ƒ</h3>

<p>ä½œæˆã•ã‚Œã‚‹ã‚‚ã®ã¯kube-legoã¨ã„ã†namespaceã¨ãªã£ã¦ã„ã‚‹ãŸã‚ã€kubectlã‚’å®Ÿè¡Œã™ã‚‹éš›ã¯<code class="highlighter-rouge">--namespace kube-lego</code>ãŒå¿…è¦ã«ãªã‚‹ã€‚</p>
:ET