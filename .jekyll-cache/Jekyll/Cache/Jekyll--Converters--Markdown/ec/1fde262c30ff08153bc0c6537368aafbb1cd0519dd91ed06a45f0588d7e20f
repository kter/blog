I"'<p>CloudFormationã§SecurityGroupã‚’ä½œã‚‹ã¨ãã«You may not define rules between a VPC group and a non-VPC groupã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã¨ãã®å¯¾å¿œ</p>

<p>è§£æ±ºã¾ã§åœ°å‘³ã«30åˆ†ç¨‹åº¦æ›ã‹ã£ãŸã®ã§ãƒ¡ãƒ¢ã€‚</p>

<p>CloudFormationã§æ¬¡ã®ã‚ˆã†ãªæ„Ÿã˜ã§SecurityGroupã‚’ä½œã‚ã†ã¨ã™ã‚‹ã¨ã€<code class="highlighter-rouge">You may not define rules between a VPC group and a non-VPC group</code>ã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦SecurityGroupãŒä½œã‚Œãªã„ã€‚</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">DBEC2SecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow</span><span class="nv"> </span><span class="s">access</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">specific</span><span class="nv"> </span><span class="s">SecurityGroup"</span>
      <span class="na">SecurityGroupIngress</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3306'</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3306'</span>
        <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s1">'</span><span class="s">EC2SecurityGroup'</span>
</code></pre></div></div>

<p>ã“ã‚Œã¯SourceSecurityGroupã«VPCã®SecurityGroupãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã®ã«ã€ï¼ˆVpcIdãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ï¼‰EC2 Classicç’°å¢ƒã«SecurityGroupãŒä½œã‚‰ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã‚‹ãŸã‚å‡ºãŸã‚¨ãƒ©ãƒ¼ã§ã‚ã‚‹ï¼ˆè¨€è‘‰ã«ã™ã‚‹ã¨ã‚„ã‚„ã“ã—ã„ï¼‰ã€‚</p>

<p><a href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html#cfn-ec2-securitygroup-vpcid">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã«ã‚‚ã‚ã‚‹ãŒæ­£ã—ãã¯ã“ã‚“ãªæ„Ÿã˜ã€‚</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">DBEC2SecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow</span><span class="nv"> </span><span class="s">access</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">specific</span><span class="nv"> </span><span class="s">SecurityGroup"</span>
      <span class="na">SecurityGroupIngress</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3306'</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3306'</span>
        <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s1">'</span><span class="s">EC2SecurityGroup'</span>
</code></pre></div></div>

<p>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯è¦‹ã¦ã„ãŸã‘ã©çœ ã‹ã£ãŸã®ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«æƒ‘ã‚ã•ã‚Œã¦è§£æ±ºã¾ã§æ™‚é–“æ›ã‹ã£ã¦ã—ã¾ã£ãŸâ€¦ã€‚</p>

:ET